[build]
  # Publish the docs/ folder as the site root
  publish = "docs"
  # No build command needed (static HTML)
  command = ""

# Redirect rules (optional - for clean URLs)
# Test change: updated redirect rule
[[redirects]]
  from = "/"
  to = "/index.html"
  status = 200

# Redirect direct .xlsx/.csv file access to viewer pages
# This ensures clicking on file links opens the viewer instead of downloading
[[redirects]]
  from = "/phases/*/Outputs/*.xlsx"
  to = "/phases/:splat/Outputs/:filename.xlsx.html"
  status = 301
  force = true

[[redirects]]
  from = "/phases/*/Inputs/*.xlsx"
  to = "/phases/:splat/Inputs/:filename.xlsx.html"
  status = 301
  force = true

[[redirects]]
  from = "/phases/*/Outputs/*.csv"
  to = "/phases/:splat/Outputs/:filename.csv.html"
  status = 301
  force = true

[[redirects]]
  from = "/phases/*/Inputs/*.csv"
  to = "/phases/:splat/Inputs/:filename.csv.html"
  status = 301
  force = true

# Auth0 protection is handled client-side via JavaScript in docs/index.html
# Get your Auth0 Client ID from: Auth0 Dashboard → Applications → Your App → Settings
# Then update docs/index.html with the correct clientID

# Note: Password protection redirects are handled client-side via JavaScript
# See docs/index.html and docs/_password_gate.html

# Ensure .nojekyll is respected (Netlify doesn't need it, but good practice)
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    # Test header to verify netlify.toml is being read
    X-Netlify-Config = "active"

# Ensure viewer pages (.xlsx.html, .csv.html) are served as HTML
# Use more specific path patterns to ensure they match
# Force browsers to display, not download
[[headers]]
  for = "/phases/*/*.xlsx.html"
  [headers.values]
    Content-Type = "text/html; charset=utf-8"
    Content-Disposition = "inline"
    X-Content-Type-Options = "nosniff"

[[headers]]
  for = "/phases/*/*.csv.html"
  [headers.values]
    Content-Type = "text/html; charset=utf-8"
    Content-Disposition = "inline"
    X-Content-Type-Options = "nosniff"

# Free password protection alternatives (Netlify's built-in password protection is paid):
# 
# Option 1: Client-side JavaScript password gate (docs/_password_gate.html)
#   - Not secure (can be bypassed), but deters casual access
#   - Edit docs/_password_gate.html and set CORRECT_PASSWORD
#   - Redirect root to password gate, or add auth check to each page
#
# Option 2: Cloudflare Access (if using Cloudflare for DNS)
#   - Free tier available
#   - Set up in Cloudflare dashboard → Zero Trust → Access
#
# Option 3: Cloudflare Workers (if using Cloudflare)
#   - Free tier: 100k requests/day
#   - Add HTTP Basic Auth via Worker script
#
# Option 4: Vercel (alternative hosting)
#   - Password protection NOT available on free tier (Enterprise/Pro only)
#   - Vercel Authentication available on free tier, but requires Vercel accounts
